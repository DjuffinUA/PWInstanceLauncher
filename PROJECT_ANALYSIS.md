# Повторний повний аналіз PWInstanceLauncher (після доопрацювань)

## Архітектурний стан
- `ConfigService`: стабільне завантаження/fallback/нормалізація, валідація `GamePath`.
- `CredentialService`: DPAPI шифрування/дешифрування.
- `ProcessService`: запуск, duplicate-check по логіну (WMI), очікування `MainWindowHandle`.
- `DesktopService`: створення/перемикання/переміщення desktop + активація вікна.
- `MainViewModel`: orchestration для add/edit/remove/launch, runtime-моніторинг, статуси, логування.

---

## Що перевірено та виправлено зараз

### 1) Логічна помилка в Edit flow
**Проблема:** при редагуванні профілю, якщо новий логін дублював існуючий, відкат робився тільки для `Login`, але вже змінені `Name`/`EncryptedPassword` могли залишатися в пам'яті.

**Виправлення:** додано повний snapshot (`Name`, `Login`, `EncryptedPassword`) і повний rollback при порушенні унікальності логіну.

### 2) Надлишкове дублювання warning-логів
**Проблема:** після `ShowWarning(...)` (який вже логує `Warn`) були додаткові `Warn` логи в тих же гілках.

**Виправлення:** прибрано дублікати для чистішого логу без втрати інформації.

### 3) Перевірка загальної логіки
- Ініціалізація `MainViewModel` після попереднього фіксу коректна (ризик `Save()` до ініціалізації `Characters` усунуто).
- Duplicate login в `Add`/`Edit` контролюється.
- Runtime monitor + cleanup працюють у поточній моделі Етапу 5.
- Логування + global exception handler + status block + change game path відповідають Етапу 6.

---

## Звіт по етапах

### Етап 1 — База
✅ Закрито.

### Етап 2 — Профілі
✅ Закрито.
- Додатково перевірено консистентність при rollback редагування.

### Етап 3 — Запуск процесу
✅ Закрито функціонально.

### Етап 4 — Desktop
✅ Закрито функціонально.

### Етап 5 — Стан/моніторинг
✅ Закрито функціонально.

### Етап 6 — Полірування
✅ Закрито функціонально.
- логування,
- глобальна обробка виключень UI,
- статус останньої операції,
- зміна `GamePath` з головного вікна.

---

## Залишкові ризики
1. Пошук процесу по логіну залежить від WMI (`Win32_Process.CommandLine`).
2. Мапінг `login -> desktop` in-memory (не персиститься між рестартами).
