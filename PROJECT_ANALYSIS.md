# Хід завдання: аналіз і закриття Етапів 1–3

## 1) Аналіз перед змінами

### Етап 1 (база)
- WPF/.NET + JSON були реалізовані.
- Проблеми: валідація конфігу була мінімальна, пошкоджений `config.json` не оброблявся, перевірка `GamePath` була розкидана по ViewModel.

### Етап 2 (профілі)
- Додавання профілів працювало.
- Проблеми: не було видалення профілю, редагування без введення пароля перезаписувало пароль порожнім значенням.

### Етап 3 (запуск)
- Базовий запуск через `ProcessStartInfo` був.
- Проблеми: частина перевірок була нестабільна, не було єдиного стабільного pipeline з валідацією і повним error-flow.

---

## 2) Зміни для закриття Етапу 1

- У `ConfigService` додано безпечне завантаження:
  - fallback при пошкодженому JSON;
  - нормалізація моделі конфігу;
  - централізована перевірка `IsGamePathValid(...)`.
- `Save(...)` тепер також проходить нормалізацію.

Результат: застосунок стабільно стартує навіть з битим `config.json`, має централізовану валідацію шляху до гри.

---

## 3) Повторний аналіз після Етапу 1

- База стала стабільнішою.
- Залишилися прогалини Етапу 2: remove-потік і коректне редагування пароля.

---

## 4) Зміни для закриття Етапу 2

- Додано команди `EditCharacterCommand` і `RemoveCharacterCommand` у `MainViewModel`.
- UI переведено на MVVM-команди (прибрано `Edit_Click` з code-behind).
- Додано кнопку `Remove` у список персонажів.
- У `EditCharacterWindow`:
  - валідація `Name`/`Login`;
  - для нового профілю пароль обов'язковий;
  - при редагуванні порожній пароль не перезаписує старий encrypted пароль.

Результат: профілі повністю керовані (add/edit/remove), пароль не втрачається при редагуванні.

---

## 5) Повторний аналіз після Етапу 2

- Етапи 1–2 функціонально закриті.
- Для Етапу 3 потрібно уніфікувати launch-flow і перевірки перед запуском.

---

## 6) Зміни для закриття Етапу 3

- `LaunchCharacter` працює як чіткий pipeline:
  1. перевірка валідності `GamePath`;
  2. валідація login/password;
  3. пошук дубля процесу по логіну;
  4. дешифрування пароля;
  5. запуск процесу;
  6. очікування `MainWindowHandle` з timeout;
  7. зрозумілі повідомлення на кожній гілці помилки.
- Збережено підготовку до Етапу 4: після запуску є `Process` і `MainWindowHandle`, придатні для `DesktopService`.

---

## 7) Підсумкова перевірка логіки проєкту

- Конфіг: є fallback + нормалізація.
- Профілі: add/edit/remove + безпечне поводження з паролем.
- Запуск: валідований і контрольований pipeline без `.bat`.
- Архітектура готова до переходу на Етап 4 (desktop mapping/switch/move) без переробки базової launch-логіки.
